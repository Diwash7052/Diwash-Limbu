<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Weather Forecast</title>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f0f4f8;
      color: #2c3e50;
      margin: 0;
      padding: 0;
    }

    div.container {
      max-width: 850px;
      margin: 30px auto;
      padding: 25px;
      background-color: #ffffff;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
      border-radius: 10px;
    }

    h1 {
      text-align: center;
      color: #007acc;
      margin-bottom: 30px;
    }

    form {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    input, select {
      padding: 12px;
      font-size: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
      width: 160px;
    }

    #weatherResult {
      margin-top: 25px;
      padding: 20px;
      background-color: #f1f9ff;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }

    #forecast div {
      margin-bottom: 18px;
      border-bottom: 1px solid #ccc;
      padding-bottom: 12px;
    }

    #forecast p {
      font-size: 14px;
      margin: 4px 0;
    }

    #status {
      font-weight: 600;
      color: #2c3e50;
    }

    .hide {
      display: none;
    }

    .shadow__btn {
      padding: 10px 20px;
      border: none;
      font-size: 17px;
      color: #fff;
      border-radius: 7px;
      letter-spacing: 4px;
      font-weight: 700;
      text-transform: uppercase;
      transition: 0.5s;
      background: rgb(0,140,255);
      box-shadow: 0 0 25px rgb(0,140,255);
    }

    .shadow__btn:hover {
      box-shadow: 0 0 5px rgb(0,140,255),
                  0 0 25px rgb(0,140,255),
                  0 0 50px rgb(0,140,255),
                  0 0 100px rgb(0,140,255);
    }

    .switch-button {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
    }

    .switch-outer {
      height: 55px;
      background: #252532;
      width: 115px;
      border-radius: 165px;
      box-shadow: inset 0px 5px 10px #16151c, 0px 3px 6px -2px #403f4e;
      border: 1px solid #32303e;
      padding: 6px;
      box-sizing: border-box;
      cursor: pointer;
    }

    .switch-outer input[type="checkbox"] {
      opacity: 0;
      position: absolute;
    }

    .switch-outer .button-toggle {
      height: 42px;
      width: 42px;
      background: linear-gradient(#3b3a4e, #272733);
      border-radius: 100%;
      box-shadow: inset 0px 5px 4px #424151, 0px 4px 15px #0f0e17;
      position: relative;
      z-index: 2;
      transition: left 0.3s ease-in;
      left: 0;
    }

    .switch-outer input[type="checkbox"]:checked + .button .button-toggle {
      left: 58%;
    }

    .switch-outer .button {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: space-between;
      position: relative;
    }

    .switch-outer .button-indicator {
      height: 25px;
      width: 25px;
      top: 50%;
      transform: translateY(-50%);
      border-radius: 50%;
      border: 3px solid #ef565f;
      right: 10px;
      position: relative;
    }

    .switch-outer input[type="checkbox"]:checked + .button .button-indicator {
      animation: indicator 1s forwards;
    }

    @keyframes indicator {
      30% { opacity: 0; }
      0% { opacity: 1; }
      100% {
        opacity: 1;
        border: 3px solid #60d480;
        left: -68%;
      }
    }
  </style>
</head>
<body>

  <label class="switch-button">
    <div class="switch-outer">
      <input id="modeToggle" type="checkbox" onchange="toggleClass()">
      <div class="button">
        <span class="button-toggle"></span>
        <span class="button-indicator"></span>
      </div>
    </div>
  </label>
  <p style="text-align: center; font-weight: bold;">Click To On Auto Mode</p>

  <div class="container">
    <h1>Weather Forecast</h1>

    <form id="locationForm" onsubmit="event.preventDefault(); getWeather();">
      <div id="man">
        <input type="number" id="latitude" placeholder="Latitude" required step="any">
        <input type="number" id="longitude" placeholder="Longitude" required step="any">
        <button class="shadow__btn" type="submit">Get Weather</button>
      </div>

      <select id="TownDropdown" onchange="handleTownChange()">
        <option value="">Select a Town</option>
        <option value="27.3314,88.6138">Gangtok</option>
        <option value="27.1408,88.1462">Sombaria</option>
        <option value="27.2925,88.2537">Geyzing</option>
        <option value="27.5005,88.5346">Mangan</option>
        <option value="27.1364,88.3931">Singtam</option>
      </select>
    </form>

    <div id="weatherResult" style="display: none;">
      <p id="status"></p>
      <div id="forecast"></div>
    </div>
  </div>

  <script>
    function toggleClass() {
      const manual = document.getElementById("man");
      manual.classList.toggle("hide");
    }

    function getWeather() {
      const latitude = parseFloat(document.getElementById("latitude").value);
      const longitude = parseFloat(document.getElementById("longitude").value);
      if (!isNaN(latitude) && !isNaN(longitude)) {
        fetchWeatherData(latitude, longitude);
      } else {
        document.getElementById("status").textContent = "Please enter valid latitude and longitude.";
        document.getElementById("weatherResult").style.display = "none";
      }
    }

    function handleTownChange() {
      const value = document.getElementById("TownDropdown").value;
      if (value) {
        const [lat, lon] = value.split(",");
        document.getElementById("latitude").value = lat.trim();
        document.getElementById("longitude").value = lon.trim();
        fetchWeatherData(lat.trim(), lon.trim());
      }
    }

    function fetchWeatherData(latitude, longitude) {
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,weathercode&timezone=Asia/Kolkata`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (data && data.daily) {
            displayWeather(data);
          } else {
            document.getElementById("status").textContent = "Weather data not available.";
            document.getElementById("weatherResult").style.display = "none";
          }
        })
        .catch(error => {
          document.getElementById("status").textContent = "Error fetching weather data.";
          document.getElementById("weatherResult").style.display = "none";
        });
    }

    function displayWeather(data) {
      const forecast = data.daily;
      let forecastHTML = "";

      const weatherConditions = {
        0: { description: "Clear", image: "ClearSky.gif" },
        1: { description: "Partly cloudy", image: "partly_cloudy.gif" },
        3: { description: "Overcast", image: "overcast.gif" },
        45: { description: "Fog", image: "cloudy.gif" },
        53: { description: "Moderate rain", image: "moderate_rain.gif" },
        66: { description: "Freezing Rain", image: "freezing_rain.gif" },
        71: { description: "Snowfall", image: "snowfall.gif" },
        95: { description: "Thunderstorm", image: "Thunderstorm.gif" },
      };

      forecast.time.forEach((date, index) => {
        const tempMax = forecast.temperature_2m_max[index];
        const tempMin = forecast.temperature_2m_min[index];
        const precipitation = forecast.precipitation_sum[index];
        const weatherCode = forecast.weathercode[index];
        const condition = weatherConditions[weatherCode] || { description: "Clear", image: "ClearSky.gif" };

        forecastHTML += `
          <div style="display: flex; align-items: center; margin-bottom: 20px;">
            <img src="${condition.image}" alt="${condition.description}" 
                 onError="this.onerror=null;this.src='fallback.gif';"
                 style="width: 180px; height: 160px; border-radius: 10px; margin-right: 20px; object-fit: cover;">
            <div>
              <p><strong>Date:</strong> ${date}</p>
              <p><strong>Weather:</strong> ${condition.description}</p>
              <p><strong>Max Temp:</strong> ${tempMax}°C | <strong>Min Temp:</strong> ${tempMin}°C</p>
              <p><strong>Precipitation:</strong> ${precipitation} mm</p>
            </div>
          </div>
        `;
      });

      document.getElementById("status").textContent = "Weather data fetched successfully!";
      document.getElementById("forecast").innerHTML = forecastHTML;
      document.getElementById("weatherResult").style.display = "block";
    }
  </script>
</body>
</html>
